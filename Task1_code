# Step 1: Import required libraries
import pandas as pd

# Step 2: Load dataset
df = pd.read_csv("Mall_Customers.csv")
print("Original Data:")
print(df.head())

# Step 3: Check for missing values
print("\nMissing values before cleaning:")
print(df.isnull().sum())

# (If dataset has nulls, we can fill or drop them)
df = df.dropna()

# Step 4: Check and remove duplicates
before = df.shape[0]
df = df.drop_duplicates()
after = df.shape[0]
print(f"\nRemoved {before - after} duplicate rows")

# Step 5: Standardize column names
df.columns = df.columns.str.lower().str.replace(' ', '_')
print("\nRenamed Columns:", list(df.columns))

# Step 6: Standardize categorical values (Gender)
if 'gender' in df.columns:
    df['gender'] = df['gender'].str.strip().str.lower().replace({
        'male': 'Male', 'female': 'Female'
    })

# Step 7: Check and correct data types
if 'age' in df.columns:
    df['age'] = df['age'].astype(int)

# Step 8: Add new derived column (Optional Example)
# Example: Age group classification
if 'age' in df.columns:
    bins = [0, 20, 30, 40, 50, 100]
    labels = ['<20', '21-30', '31-40', '41-50', '50+']
    df['age_group'] = pd.cut(df['age'], bins=bins, labels=labels)

# Step 9: Verify cleaned data
print("\nCleaned Data Sample:")
print(df.head())

# Step 10: Save cleaned dataset
df.to_csv("cleaned_mall_customers.csv", index=False)
print("\nâœ… Cleaned dataset saved successfully as 'cleaned_mall_customers.csv'")
